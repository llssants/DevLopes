{% load static %}
<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Perfil - Success</title>
  <link rel="stylesheet" href="../static/perfil.css">
</head>
<body>
  <div class="container">
    
    <!-- Sidebar -->
    <aside class="sidebar">
      <h2 class="logo">SUCCESS</h2>
      <ul>
        <li><a href="#">Perfil</a></li>
        <li><a href="#">Reuniões</a></li>
        <li><a href="{% url 'chat' %}">Mensagens</a></li>
        <li><a href="{% url 'trabalhos' %}">Meus trabalhos</a></li>
<li>
  {% if aluno and projetos %}
    <a href="{% url 'progresso_aluno' aluno.id projetos.0.id %}">Meu Progresso</a>
  {% else %}
    <span>Meu Progresso (indisponível)</span>
  {% endif %}
</li>
        <li><a href="#">Ajuda</a></li>
      </ul>
    </aside>

    <!-- Conteúdo -->
    <main class="content">

      <!-- Header -->
      <header>
        <h2>Perfil</h2>
        <input type="text" placeholder="Pesquisar...">
      </header>

      <!-- Dados do aluno -->
      <section class="card perfil-card">
        <div class="perfil-info">
          <div>
            <h3>{{ aluno.user.get_full_name }}</h3>
            <p><b>Email:</b> {{ aluno.user.email }}</p>
            <p><b>Telefone:</b> {{ aluno.telefone }}</p>
            <p><b>Cidade:</b> {{ aluno.cidade }}</p>
            <p><b>Nascimento:</b> {{ aluno.data_nascimento }}</p>
          </div>
        </div>
      </section>

      <!-- Calendário -->
      <section class="card calendario-card">
        <h3>Calendário</h3>
        <div id="calendario"></div>
      </section>

      <!-- Projetos -->
      <section class="card projetos-card">
        <h3>Projetos</h3>
        <ul>
          {% for p in projetos %}
            <li>
              <b>{{ p.titulo }}</b> - {{ p.descricao }}
              <span>(Entrega: {{ p.data_entrega }})</span>
            </li>
          {% empty %}
            <li>Nenhum projeto cadastrado</li>
          {% endfor %}
        </ul>
      </section>

    </main>
  </div>
</body>
<script>
    document.addEventListener("DOMContentLoaded", function () {
  const calendario = document.getElementById("calendario");
  const hoje = new Date();

  const ano = hoje.getFullYear();
  const mes = hoje.getMonth();
  const primeiroDia = new Date(ano, mes, 1);
  const ultimoDia = new Date(ano, mes + 1, 0);

  // cabeçalho dos dias
  const diasSemana = ["Dom", "Seg", "Ter", "Qua", "Qui", "Sex", "Sáb"];
  diasSemana.forEach(d => {
    const div = document.createElement("div");
    div.innerText = d;
    div.style.fontWeight = "bold";
    calendario.appendChild(div);
  });

  // espaços antes do primeiro dia
  for (let i = 0; i < primeiroDia.getDay(); i++) {
    calendario.appendChild(document.createElement("div"));
  }

  // dias do mês
  for (let d = 1; d <= ultimoDia.getDate(); d++) {
    const data = new Date(ano, mes, d);
    const div = document.createElement("div");
    div.innerText = d;

    // marca hoje
    if (data.toDateString() === hoje.toDateString()) {
      div.classList.add("hoje");
    }

    // exemplo: marcar evento (pode ser passado do Django depois)
    if (d === 10 || d === 22) {
      div.classList.add("evento");
    }

    calendario.appendChild(div);
  }
});

</script>
</html>
